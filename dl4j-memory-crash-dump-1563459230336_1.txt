Deeplearning4j OOM Exception Encountered for ComputationGraph
Timestamp:                              2019-07-18 19:43:50.336
Thread ID                               1
Thread Name                             main


Stack Trace:
java.lang.OutOfMemoryError: Cannot allocate new LongPointer(8): totalBytes = 2300M, physicalBytes = 7373M
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:76)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:41)
	at org.nd4j.linalg.api.buffer.BaseDataBuffer.<init>(BaseDataBuffer.java:385)
	at org.nd4j.linalg.api.buffer.LongBuffer.<init>(LongBuffer.java:81)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:436)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:431)
	at org.nd4j.linalg.factory.Nd4j.createBufferDetached(Nd4j.java:1462)
	at org.nd4j.linalg.api.shape.Shape.createShapeInformation(Shape.java:3223)
	at org.nd4j.linalg.api.ndarray.BaseShapeInfoProvider.createShapeInformation(BaseShapeInfoProvider.java:94)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:92)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:78)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.<init>(BaseNDArray.java:185)
	at org.nd4j.linalg.cpu.nativecpu.NDArray.<init>(NDArray.java:81)
	at org.nd4j.linalg.cpu.nativecpu.CpuNDArrayFactory.create(CpuNDArrayFactory.java:299)
	at org.nd4j.linalg.factory.Nd4j.create(Nd4j.java:3945)
	at org.nd4j.linalg.api.shape.Shape.newShapeNoCopy(Shape.java:2046)
	at org.nd4j.linalg.learning.NesterovsUpdater.setStateViewArray(NesterovsUpdater.java:55)
	at org.nd4j.linalg.learning.config.Nesterovs.instantiate(Nesterovs.java:98)
	at org.deeplearning4j.nn.updater.UpdaterBlock.init(UpdaterBlock.java:93)
	at org.deeplearning4j.nn.updater.BaseMultiLayerUpdater.<init>(BaseMultiLayerUpdater.java:179)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:44)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:40)
	at org.deeplearning4j.optimize.solvers.BaseOptimizer.updateGradientAccordingToParams(BaseOptimizer.java:283)
	at org.deeplearning4j.optimize.solvers.BaseOptimizer.gradientAndScore(BaseOptimizer.java:172)
	at org.deeplearning4j.optimize.solvers.StochasticGradientDescent.optimize(StochasticGradientDescent.java:63)
	at org.deeplearning4j.optimize.Solver.optimize(Solver.java:52)
	at org.deeplearning4j.nn.graph.ComputationGraph.fitHelper(ComputationGraph.java:1149)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1098)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1065)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1025)
	at deep.learning.cnn.ImageClassifier2.run(ImageClassifier2.java:144)
	at deep.learning.cnn.ImageClassifier2.main(ImageClassifier2.java:313)
Caused by: java.lang.OutOfMemoryError: Physical memory usage is too high: physicalBytes (7373M) > maxPhysicalBytes (7232M)
	at org.bytedeco.javacpp.Pointer.deallocator(Pointer.java:584)
	at org.bytedeco.javacpp.Pointer.init(Pointer.java:124)
	at org.bytedeco.javacpp.LongPointer.allocateArray(Native Method)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:68)
	... 31 more


<Error generating network memory status information section>java.lang.OutOfMemoryError: Cannot allocate new LongPointer(8): totalBytes = 2300M, physicalBytes = 7380M
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:76)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:41)
	at org.nd4j.linalg.api.buffer.BaseDataBuffer.<init>(BaseDataBuffer.java:385)
	at org.nd4j.linalg.api.buffer.LongBuffer.<init>(LongBuffer.java:81)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:436)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:431)
	at org.nd4j.linalg.factory.Nd4j.createBufferDetached(Nd4j.java:1462)
	at org.nd4j.linalg.api.shape.Shape.createShapeInformation(Shape.java:3223)
	at org.nd4j.linalg.api.ndarray.BaseShapeInfoProvider.createShapeInformation(BaseShapeInfoProvider.java:94)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:92)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:78)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.<init>(BaseNDArray.java:185)
	at org.nd4j.linalg.cpu.nativecpu.NDArray.<init>(NDArray.java:81)
	at org.nd4j.linalg.cpu.nativecpu.CpuNDArrayFactory.create(CpuNDArrayFactory.java:299)
	at org.nd4j.linalg.factory.Nd4j.create(Nd4j.java:3945)
	at org.nd4j.linalg.api.shape.Shape.newShapeNoCopy(Shape.java:2046)
	at org.nd4j.linalg.learning.NesterovsUpdater.setStateViewArray(NesterovsUpdater.java:55)
	at org.nd4j.linalg.learning.config.Nesterovs.instantiate(Nesterovs.java:98)
	at org.deeplearning4j.nn.updater.UpdaterBlock.init(UpdaterBlock.java:93)
	at org.deeplearning4j.nn.updater.BaseMultiLayerUpdater.<init>(BaseMultiLayerUpdater.java:179)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:44)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:40)
	at org.deeplearning4j.optimize.solvers.BaseOptimizer.getComputationGraphUpdater(BaseOptimizer.java:134)
	at org.deeplearning4j.nn.graph.ComputationGraph.getUpdater(ComputationGraph.java:2839)
	at org.deeplearning4j.util.CrashReportingUtil.generateMemoryStatus(CrashReportingUtil.java:281)
	at org.deeplearning4j.util.CrashReportingUtil.writeMemoryCrashDump(CrashReportingUtil.java:160)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1100)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1065)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1025)
	at deep.learning.cnn.ImageClassifier2.run(ImageClassifier2.java:144)
	at deep.learning.cnn.ImageClassifier2.main(ImageClassifier2.java:313)
Caused by: java.lang.OutOfMemoryError: Physical memory usage is too high: physicalBytes (7380M) > maxPhysicalBytes (7232M)
	at org.bytedeco.javacpp.Pointer.deallocator(Pointer.java:584)
	at org.bytedeco.javacpp.Pointer.init(Pointer.java:124)
	at org.bytedeco.javacpp.LongPointer.allocateArray(Native Method)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:68)
	... 30 more
